<!DOCTYPE html>
<html lang="ru">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>–ú–æ–∏ C# –ü—Ä–∏–ª–æ–∂–µ–Ω–∏—è</title>
    <style>
        /* === –û–°–ù–û–í–ù–´–ï –°–¢–ò–õ–ò === */
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: 'Courier New', monospace;
            background: #0a0a0a;
            color: #e0e0e0;
            line-height: 1.6;
            padding: 20px;
            background-image: radial-gradient(circle at 20% 30%, rgba(0, 168, 89, 0.05) 0%, transparent 20%);
        }

        .container {
            max-width: 1200px;
            margin: 0 auto;
        }

        /* === –®–ê–ü–ö–ê === */
        .header {
            text-align: center;
            margin-bottom: 40px;
            padding: 30px;
            background: #1a1a1a;
            border-radius: 10px;
            border: 2px solid #333;
        }

        .header h1 {
            color: #00A859;
            font-size: 2.5rem;
            margin-bottom: 10px;
            text-shadow: 0 0 10px rgba(0, 168, 89, 0.3);
        }

        .header p {
            color: #aaa;
            font-size: 1.1rem;
            margin-bottom: 20px;
        }

        .stats-bar {
            display: flex;
            justify-content: center;
            gap: 30px;
            margin-top: 20px;
            flex-wrap: wrap;
        }

        .stat-item {
            text-align: center;
        }

        .stat-number {
            color: #00A859;
            font-size: 1.8rem;
            font-weight: bold;
        }

        .stat-label {
            color: #888;
            font-size: 0.9rem;
        }

        /* === –ü–ê–ù–ï–õ–¨ –ü–û–ò–°–ö–ê –ò –§–ò–õ–¨–¢–†–û–í === */
        .controls {
            background: #1a1a1a;
            padding: 20px;
            border-radius: 10px;
            border: 1px solid #333;
            margin-bottom: 30px;
        }

        .info-banner {
            background: linear-gradient(135deg, #00A859 0%, #008f4c 100%);
            color: white;
            padding: 12px 20px;
            border-radius: 8px;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
            font-size: 0.9rem;
        }

        .info-banner .icon {
            font-size: 1.2rem;
        }

        .search-bar {
            display: flex;
            gap: 15px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .search-input {
            flex: 1;
            min-width: 250px;
            background: #222;
            border: 1px solid #444;
            color: #e0e0e0;
            padding: 12px 15px;
            border-radius: 5px;
            font-family: 'Courier New', monospace;
            font-size: 1rem;
        }

        .search-input:focus {
            outline: none;
            border-color: #00A859;
        }

        .filter-tags {
            display: flex;
            gap: 10px;
            flex-wrap: wrap;
        }

        .tag-filter {
            background: #222;
            color: #aaa;
            padding: 8px 15px;
            border-radius: 20px;
            border: 1px solid #444;
            cursor: pointer;
            transition: all 0.3s;
            font-size: 0.9rem;
        }

        .tag-filter:hover {
            border-color: #00A859;
            color: #00A859;
        }

        .tag-filter.active {
            background: #00A859;
            color: white;
            border-color: #00A859;
        }

        /* === –ö–ê–†–¢–û–ß–ö–ò –ü–†–ò–õ–û–ñ–ï–ù–ò–ô === */
        .apps-grid {
            display: grid;
            grid-template-columns: repeat(auto-fill, minmax(320px, 1fr));
            gap: 25px;
            margin-top: 30px;
        }

        .app-card {
            background: #222;
            border-radius: 10px;
            overflow: hidden;
            border: 1px solid #333;
            transition: transform 0.3s, border-color 0.3s, box-shadow 0.3s;
            position: relative;
        }

        .app-card:hover {
            transform: translateY(-5px);
            border-color: #00A859;
            box-shadow: 0 5px 20px rgba(0, 168, 89, 0.2);
        }

        .app-image {
            height: 180px;
            overflow: hidden;
            background: #000;
            position: relative;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .app-image img {
            width: 100%;
            height: 100%;
            object-fit: cover;
        }

        .app-image .no-image-text {
            color: #666;
            font-size: 0.95rem;
            text-align: center;
            padding: 20px;
        }

        .app-badges {
            position: absolute;
            top: 10px;
            right: 10px;
            display: flex;
            gap: 5px;
            flex-direction: column;
            align-items: flex-end;
        }

        .app-badge {
            background: #68217A;
            color: white;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .version-badge {
            background: #00A859;
            color: white;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
        }

        .new-badge {
            background: #ff6b6b;
            color: white;
            padding: 4px 10px;
            border-radius: 4px;
            font-size: 0.75rem;
            font-weight: bold;
            animation: pulse 2s infinite;
        }

        @keyframes pulse {
            0%, 100% { opacity: 1; }
            50% { opacity: 0.7; }
        }

        .app-content {
            padding: 20px;
        }

        .app-title {
            color: #00A859;
            font-size: 1.3rem;
            margin-bottom: 10px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .app-rating {
            display: flex;
            gap: 2px;
        }

        .star {
            color: #ffd700;
            font-size: 1rem;
        }

        .star.empty {
            color: #444;
        }

        .app-meta {
            display: grid;
            grid-template-columns: 1fr 1fr;
            gap: 10px;
            margin-bottom: 15px;
            color: #aaa;
            font-size: 0.85rem;
        }

        .meta-item {
            display: flex;
            align-items: center;
            gap: 5px;
        }

        .app-description {
            margin-bottom: 15px;
            line-height: 1.5;
            color: #ccc;
        }

        .app-tags {
            display: flex;
            gap: 8px;
            margin-bottom: 15px;
            flex-wrap: wrap;
        }

        .app-tag {
            background: #2a2a2a;
            color: #00A859;
            padding: 4px 10px;
            border-radius: 12px;
            font-size: 0.8rem;
            border: 1px solid #333;
        }

        .app-details {
            background: #1a1a1a;
            padding: 12px;
            border-radius: 5px;
            margin-bottom: 15px;
            font-size: 0.85rem;
        }

        .detail-row {
            display: flex;
            justify-content: space-between;
            padding: 5px 0;
            border-bottom: 1px solid #2a2a2a;
        }

        .detail-row:last-child {
            border-bottom: none;
        }

        .detail-label {
            color: #888;
        }

        .detail-value {
            color: #e0e0e0;
            font-weight: bold;
        }

        .app-actions {
            display: flex;
            gap: 10px;
            justify-content: space-between;
            align-items: center;
        }

        .download-btn {
            flex: 1;
            background: #00A859;
            color: white;
            padding: 12px 20px;
            border-radius: 5px;
            text-decoration: none;
            font-weight: bold;
            transition: background 0.3s;
            cursor: pointer;
            border: none;
            font-family: 'Courier New', monospace;
            text-align: center;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 8px;
        }

        .download-btn:hover {
            background: #008f4c;
        }

        .download-count {
            background: #2a2a2a;
            color: #aaa;
            padding: 8px 12px;
            border-radius: 5px;
            font-size: 0.85rem;
            border: 1px solid #333;
            white-space: nowrap;
        }

        /* === –§–£–¢–ï–† === */
        .footer {
            text-align: center;
            margin-top: 50px;
            padding: 20px;
            color: #666;
            border-top: 1px solid #333;
        }

        /* === –°–û–û–ë–©–ï–ù–ò–Ø === */
        .no-results {
            text-align: center;
            padding: 50px;
            color: #666;
        }

        .no-results h3 {
            color: #888;
            margin-bottom: 10px;
        }

        /* === –ê–î–ê–ü–¢–ò–í–ù–û–°–¢–¨ === */
        @media (max-width: 768px) {
            .apps-grid {
                grid-template-columns: 1fr;
            }

            .stats-bar {
                gap: 15px;
            }

            .search-bar {
                flex-direction: column;
            }

            .app-meta {
                grid-template-columns: 1fr;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- –®–ê–ü–ö–ê -->
        <header class="header">
            <h1>üéÆ –ú–æ–∏ C# –ü—Ä–æ–µ–∫—Ç—ã</h1>
            <p>–ö–æ–ª–ª–µ–∫—Ü–∏—è –∏–≥—Ä –∏ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π –Ω–∞ C#</p>
            
            <div class="stats-bar">
                <div class="stat-item">
                    <div class="stat-number" id="totalApps">0</div>
                    <div class="stat-label">–ü—Ä–æ–µ–∫—Ç–æ–≤</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="totalDownloads">0</div>
                    <div class="stat-label">–°–∫–∞—á–∏–≤–∞–Ω–∏–π</div>
                </div>
                <div class="stat-item">
                    <div class="stat-number" id="totalHours">0</div>
                    <div class="stat-label">–ß–∞—Å–æ–≤ —Ä–∞–∑—Ä–∞–±–æ—Ç–∫–∏</div>
                </div>
            </div>
        </header>

        <!-- –ü–ê–ù–ï–õ–¨ –£–ü–†–ê–í–õ–ï–ù–ò–Ø -->
        <div class="controls">
            <div class="info-banner">
                <span class="icon">‚è≥</span>
                <span>–ó–∞–≥—Ä—É–∑–∫–∞...</span>
            </div>
            <div class="search-bar">
                <input 
                    type="text" 
                    class="search-input" 
                    id="searchInput" 
                    placeholder="üîç –ü–æ–∏—Å–∫ –ø–æ –Ω–∞–∑–≤–∞–Ω–∏—é –∏–ª–∏ –æ–ø–∏—Å–∞–Ω–∏—é..."
                >
            </div>
            <div class="filter-tags" id="filterTags">
                <!-- –¢–µ–≥–∏ –±—É–¥—É—Ç –∑–∞–≥—Ä—É–∂–µ–Ω—ã –¥–∏–Ω–∞–º–∏—á–µ—Å–∫–∏ -->
            </div>
        </div>

        <!-- –ö–û–ù–¢–ï–ô–ù–ï–† –î–õ–Ø –ü–†–ò–õ–û–ñ–ï–ù–ò–ô -->
        <main>
            <div class="apps-grid" id="appsContainer">
                <!-- –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø –ë–£–î–£–¢ –ó–ê–ì–†–£–ñ–ï–ù–´ –ó–î–ï–°–¨ -->
            </div>
            
            <!-- –°–æ–æ–±—â–µ–Ω–∏–µ –µ—Å–ª–∏ –Ω–µ—Ç —Ä–µ–∑—É–ª—å—Ç–∞—Ç–æ–≤ -->
            <div id="noResults" class="no-results" style="display: none;">
                <h3>üòï –ù–∏—á–µ–≥–æ –Ω–µ –Ω–∞–π–¥–µ–Ω–æ</h3>
                <p>–ü–æ–ø—Ä–æ–±—É–π—Ç–µ –∏–∑–º–µ–Ω–∏—Ç—å –ø–∞—Ä–∞–º–µ—Ç—Ä—ã –ø–æ–∏—Å–∫–∞</p>
            </div>
        </main>

        <!-- –§–£–¢–ï–† -->
        <footer class="footer">
            <p>¬© 2026 | C# Portfolio | –ú–æ–∏ –ø—Ä–æ–µ–∫—Ç—ã –Ω–∞ C#</p>
            <p style="font-size: 0.9rem; margin-top: 10px; color: #444;">
                –í—Å–µ –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è —Å–æ–∑–¥–∞–Ω—ã –º–Ω–æ–π. –ù–∞—Å–ª–∞–∂–¥–∞–π—Ç–µ—Å—å –ø—Ä–æ—Å–º–æ—Ç—Ä–æ–º!
            </p>
        </footer>
    </div>

    <script>
        // ============================
        // –ë–ê–ó–ê –î–ê–ù–ù–´–• –ü–†–ò–õ–û–ñ–ï–ù–ò–ô
        // ============================
        // –ö–ê–ö –£–ó–ù–ê–¢–¨ –†–ê–ó–ú–ï–† –§–ê–ô–õ–ê:
        // 1. –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª –Ω–∞ –∫–æ–º–ø—å—é—Ç–µ—Ä
        // 2. –ù–∞–∂–º–∏—Ç–µ –ø—Ä–∞–≤–æ–π –∫–Ω–æ–ø–∫–æ–π -> –°–≤–æ–π—Å—Ç–≤–∞
        // 3. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –∏ —É–∫–∞–∂–∏—Ç–µ –≤ –ø–æ–ª–µ fileSize
        // –ù–∞–ø—Ä–∏–º–µ—Ä: 215 MB, 1.5 GB –∏ —Ç.–¥.
        
        let csharpApps = [
            {
                id: 1,
                name: "Dog Clicker",
                version: "0.1.0-alpha",
                image: "", 
                description: "–ò–≥—Ä–∞ –µ—â—ë –≤ Alpha —Ç–∞–∫ —á—Ç–æ —Ç—É—Ç –º–∞–ª–æ —á–µ–≥–æ –µ—Å—Ç—å. –ö–ª–∏–∫–∞–π—Ç–µ –Ω–∞ —Å–æ–±–∞–∫—É –∏ –ø–æ–ª—É—á–∞–π—Ç–µ –æ—á–∫–∏!",
                developmentTime: "4 —á–∞—Å–∞",
                fileSize: 200, // –£–∫–∞–∂–∏—Ç–µ —Ä–µ–∞–ª—å–Ω—ã–π —Ä–∞–∑–º–µ—Ä —Ñ–∞–π–ª–∞ –≤ –ú–ë
                fileSizeUnit: "MB",
                projectUrl: "https://www.dropbox.com/scl/fi/h50mcexpoe97bungnbqiv/Clicker.zip?rlkey=4x6od6yzxkjddvxoj9773i3oq&st=47wwrnj3&dl=1",
                added: "2026-02-07",
                updated: "2026-02-07",
                rating: 4,
                tags: ["–ò–≥—Ä–∞", "–ö–ª–∏–∫–µ—Ä", "–ö–∞–∑—É–∞–ª—å–Ω–∞—è"],
                requirements: "Windows 7+, .NET 6.0",
                language: "C# 10"
            }
            // –î–û–ë–ê–í–õ–Ø–ô–¢–ï –ù–û–í–´–ï –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø –ó–î–ï–°–¨:
            // {
            //     id: 2,
            //     name: "–í–∞—à–∞ –∏–≥—Ä–∞",
            //     version: "1.0.0",
            //     image: "https://example.com/image.jpg",
            //     description: "–û–ø–∏—Å–∞–Ω–∏–µ –∏–≥—Ä—ã",
            //     developmentTime: "1 –º–µ—Å—è—Ü",
            //     fileSize: 10,
            //     fileSizeUnit: "MB",
            //     projectUrl: "https://github.com/your-project",
            //     added: "2026-01-20",
            //     updated: "2026-02-01",
            //     rating: 5,
            //     tags: ["–ò–≥—Ä–∞", "3D", "–®—É—Ç–µ—Ä"],
            //     requirements: "Windows 10+, .NET 8.0",
            //     language: "C# 12"
            // }
        ];

        // ============================
        // –•–†–ê–ù–ò–õ–ò–©–ï –°–¢–ê–¢–ò–°–¢–ò–ö–ò
        // ============================
        // –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–∏ –∏—Å–ø–æ–ª—å–∑—É–µ—Ç window.storage (–µ—Å–ª–∏ –¥–æ—Å—Ç—É–ø–µ–Ω) –∏–ª–∏ localStorage (fallback)
        class StatsManager {
            constructor() {
                this.cache = {}; // –õ–æ–∫–∞–ª—å–Ω—ã–π –∫—ç—à –¥–ª—è –±—ã—Å—Ç—Ä–æ–≥–æ –¥–æ—Å—Ç—É–ø–∞
                this.useServerStorage = typeof window.storage !== 'undefined';
                this.localStorageKey = 'csharpAppsStats';
                
                if (this.useServerStorage) {
                    console.log('‚úÖ –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è —Å–µ—Ä–≤–µ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (–¥–∞–Ω–Ω—ã–µ –≤–∏–¥–Ω—ã –≤—Å–µ–º –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º)');
                } else {
                    console.log('‚ö†Ô∏è –ò—Å–ø–æ–ª—å–∑—É–µ—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ (–¥–∞–Ω–Ω—ã–µ —Ç–æ–ª—å–∫–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ)');
                }
            }

            // –ü–æ–ª—É—á–∏—Ç—å –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π –¥–ª—è –ø—Ä–∏–ª–æ–∂–µ–Ω–∏—è
            async getDownloads(appId) {
                const key = `downloads:app_${appId}`;
                
                // –ü—Ä–æ–≤–µ—Ä—è–µ–º –∫—ç—à
                if (this.cache[key] !== undefined) {
                    return this.cache[key];
                }
                
                try {
                    if (this.useServerStorage) {
                        // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–µ—Ä–≤–µ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
                        const result = await window.storage.get(key, true);
                        const downloads = result ? parseInt(result.value) : 0;
                        this.cache[key] = downloads;
                        return downloads;
                    } else {
                        // Fallback –Ω–∞ localStorage
                        const data = this.loadLocalStorage();
                        const downloads = data[appId]?.downloads || 0;
                        this.cache[key] = downloads;
                        return downloads;
                    }
                } catch (error) {
                    console.log('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–ª—É—á–∏—Ç—å —Å—á–µ—Ç—á–∏–∫:', error);
                    return 0;
                }
            }

            // –£–≤–µ–ª–∏—á–∏—Ç—å —Å—á–µ—Ç—á–∏–∫ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π
            async incrementDownloads(appId) {
                const key = `downloads:app_${appId}`;
                
                try {
                    const current = await this.getDownloads(appId);
                    const newCount = current + 1;
                    
                    if (this.useServerStorage) {
                        // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–µ—Ä–≤–µ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
                        await window.storage.set(key, newCount.toString(), true);
                    } else {
                        // Fallback –Ω–∞ localStorage
                        const data = this.loadLocalStorage();
                        if (!data[appId]) {
                            data[appId] = { downloads: 0 };
                        }
                        data[appId].downloads = newCount;
                        this.saveLocalStorage(data);
                    }
                    
                    this.cache[key] = newCount;
                    return newCount;
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –ø—Ä–∏ —É–≤–µ–ª–∏—á–µ–Ω–∏–∏ —Å—á–µ—Ç—á–∏–∫–∞:', error);
                    return this.cache[key] || 0;
                }
            }

            // –ü–æ–ª—É—á–∏—Ç—å –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π –≤—Å–µ—Ö –ø—Ä–∏–ª–æ–∂–µ–Ω–∏–π
            async getTotalDownloads() {
                try {
                    if (this.useServerStorage) {
                        // –ò—Å–ø–æ–ª—å–∑—É–µ–º —Å–µ—Ä–≤–µ—Ä–Ω–æ–µ —Ö—Ä–∞–Ω–∏–ª–∏—â–µ
                        const keys = await window.storage.list('downloads:', true);
                        
                        if (!keys || !keys.keys) {
                            return 0;
                        }
                        
                        let total = 0;
                        for (const key of keys.keys) {
                            try {
                                const result = await window.storage.get(key, true);
                                if (result) {
                                    total += parseInt(result.value) || 0;
                                }
                            } catch (e) {
                                console.log('–û—à–∏–±–∫–∞ —á—Ç–µ–Ω–∏—è –∫–ª—é—á–∞:', key);
                            }
                        }
                        
                        return total;
                    } else {
                        // Fallback –Ω–∞ localStorage
                        const data = this.loadLocalStorage();
                        return Object.values(data).reduce((sum, app) => sum + (app.downloads || 0), 0);
                    }
                } catch (error) {
                    console.log('–ù–µ —É–¥–∞–ª–æ—Å—å –ø–æ–¥—Å—á–∏—Ç–∞—Ç—å –æ–±—â–∏–µ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è:', error);
                    return 0;
                }
            }

            // –ó–∞–≥—Ä—É–∑–∫–∞ –¥–∞–Ω–Ω—ã—Ö –∏–∑ localStorage
            loadLocalStorage() {
                try {
                    const saved = localStorage.getItem(this.localStorageKey);
                    return saved ? JSON.parse(saved) : {};
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ –∑–∞–≥—Ä—É–∑–∫–∏ localStorage:', error);
                    return {};
                }
            }

            // –°–æ—Ö—Ä–∞–Ω–µ–Ω–∏–µ –¥–∞–Ω–Ω—ã—Ö –≤ localStorage
            saveLocalStorage(data) {
                try {
                    localStorage.setItem(this.localStorageKey, JSON.stringify(data));
                } catch (error) {
                    console.error('–û—à–∏–±–∫–∞ —Å–æ—Ö—Ä–∞–Ω–µ–Ω–∏—è –≤ localStorage:', error);
                }
            }
        }

        const statsManager = new StatsManager();

        // ============================
        // –û–°–ù–û–í–ù–ê–Ø –õ–û–ì–ò–ö–ê
        // ============================
        document.addEventListener('DOMContentLoaded', function() {
            const appsContainer = document.getElementById('appsContainer');
            const noResults = document.getElementById('noResults');
            const searchInput = document.getElementById('searchInput');
            const filterTagsContainer = document.getElementById('filterTags');
            
            let activeFilters = new Set();
            let searchQuery = '';

            // ============================
            // –§–£–ù–ö–¶–ò–Ø: –ü–û–õ–£–ß–ï–ù–ò–ï –í–°–ï–• –¢–ï–ì–û–í
            // ============================
            function getAllTags() {
                const tagsSet = new Set();
                csharpApps.forEach(app => {
                    app.tags.forEach(tag => tagsSet.add(tag));
                });
                return Array.from(tagsSet);
            }

            // ============================
            // –§–£–ù–ö–¶–ò–Ø: –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –§–ò–õ–¨–¢–†–û–í
            // ============================
            function renderFilters() {
                const tags = getAllTags();
                filterTagsContainer.innerHTML = `
                    <div class="tag-filter ${activeFilters.size === 0 ? 'active' : ''}" data-tag="all">
                        –í—Å–µ
                    </div>
                `;
                
                tags.forEach(tag => {
                    const filterBtn = document.createElement('div');
                    filterBtn.className = 'tag-filter';
                    filterBtn.dataset.tag = tag;
                    filterBtn.textContent = tag;
                    if (activeFilters.has(tag)) {
                        filterBtn.classList.add('active');
                    }
                    filterTagsContainer.appendChild(filterBtn);
                });

                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ –∫–ª–∏–∫–æ–≤
                document.querySelectorAll('.tag-filter').forEach(btn => {
                    btn.addEventListener('click', function() {
                        const tag = this.dataset.tag;
                        
                        if (tag === 'all') {
                            activeFilters.clear();
                        } else {
                            if (activeFilters.has(tag)) {
                                activeFilters.delete(tag);
                            } else {
                                activeFilters.add(tag);
                            }
                        }
                        
                        renderFilters();
                        renderApps();
                    });
                });
            }

            // ============================
            // –§–£–ù–ö–¶–ò–Ø: –§–ò–õ–¨–¢–†–ê–¶–ò–Ø –ü–†–ò–õ–û–ñ–ï–ù–ò–ô
            // ============================
            function filterApps() {
                return csharpApps.filter(app => {
                    // –§–∏–ª—å—Ç—Ä –ø–æ –ø–æ–∏—Å–∫—É
                    const matchesSearch = searchQuery === '' || 
                        app.name.toLowerCase().includes(searchQuery.toLowerCase()) ||
                        app.description.toLowerCase().includes(searchQuery.toLowerCase());
                    
                    // –§–∏–ª—å—Ç—Ä –ø–æ —Ç–µ–≥–∞–º
                    const matchesTags = activeFilters.size === 0 || 
                        app.tags.some(tag => activeFilters.has(tag));
                    
                    return matchesSearch && matchesTags;
                });
            }

            // ============================
            // –§–£–ù–ö–¶–ò–Ø: –ü–†–û–í–ï–†–ö–ê –ù–ê –ù–û–í–ò–ó–ù–£
            // ============================
            function isNew(dateString) {
                const addedDate = new Date(dateString);
                const now = new Date();
                const daysDiff = (now - addedDate) / (1000 * 60 * 60 * 24);
                return daysDiff <= 7; // –ù–æ–≤–æ–µ –µ—Å–ª–∏ –º–µ–Ω—å—à–µ 7 –¥–Ω–µ–π
            }

            // ============================
            // –§–£–ù–ö–¶–ò–Ø: –§–û–†–ú–ê–¢–ò–†–û–í–ê–ù–ò–ï –†–ê–ó–ú–ï–†–ê
            // ============================
            function formatSize(size, unit) {
                if (size >= 1024 && unit === "MB") {
                    return (size / 1024).toFixed(2) + " GB";
                }
                return size + " " + unit;
            }

            // ============================
            // –§–£–ù–ö–¶–ò–Ø: –ü–û–õ–£–ß–ï–ù–ò–ï –†–ï–ê–õ–¨–ù–û–ì–û –†–ê–ó–ú–ï–†–ê –§–ê–ô–õ–ê
            // ============================
            // –ü–†–ò–ú–ï–ß–ê–ù–ò–ï: –ê–≤—Ç–æ–º–∞—Ç–∏—á–µ—Å–∫–æ–µ –ø–æ–ª—É—á–µ–Ω–∏–µ —Ä–∞–∑–º–µ—Ä–∞ –æ—Ç–∫–ª—é—á–µ–Ω–æ –∏–∑-–∑–∞ CORS
            // –£–∫–∞–∑—ã–≤–∞–π—Ç–µ —Ä–∞–∑–º–µ—Ä –≤—Ä—É—á–Ω—É—é –≤ –º–∞—Å—Å–∏–≤–µ csharpApps
            // –ß—Ç–æ–±—ã —É–∑–Ω–∞—Ç—å —Ä–∞–∑–º–µ—Ä:
            // 1. –°–∫–∞—á–∞–π—Ç–µ —Ñ–∞–π–ª
            // 2. –ü–æ—Å–º–æ—Ç—Ä–∏—Ç–µ —Ä–∞–∑–º–µ—Ä –≤ —Å–≤–æ–π—Å—Ç–≤–∞—Ö —Ñ–∞–π–ª–∞
            // 3. –£–∫–∞–∂–∏—Ç–µ –≤ –ø–æ–ª–µ fileSize

            // ============================
            // –§–£–ù–ö–¶–ò–Ø: –û–¢–û–ë–†–ê–ñ–ï–ù–ò–ï –ó–í–ï–ó–î
            // ============================
            function renderStars(rating) {
                let stars = '';
                for (let i = 1; i <= 5; i++) {
                    stars += `<span class="star ${i <= rating ? '' : 'empty'}">‚òÖ</span>`;
                }
                return stars;
            }

            // ============================
            // –§–£–ù–ö–¶–ò–Ø: –û–¢–û–ë–†–ê–ó–ò–¢–¨ –ü–†–ò–õ–û–ñ–ï–ù–ò–Ø
            // ============================
            async function renderApps() {
                appsContainer.innerHTML = '';
                const filteredApps = filterApps();
                
                if (filteredApps.length === 0) {
                    noResults.style.display = 'block';
                    return;
                }
                
                noResults.style.display = 'none';
                
                // –°–æ—Ä—Ç–∏—Ä—É–µ–º –ø–æ –¥–∞—Ç–µ (–Ω–æ–≤—ã–µ —Å–≤–µ—Ä—Ö—É)
                const sortedApps = [...filteredApps].sort((a, b) => 
                    new Date(b.added) - new Date(a.added)
                );
                
                // –ó–∞–≥—Ä—É–∂–∞–µ–º —Å—á–µ—Ç—á–∏–∫–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π
                const downloadsMap = {};
                for (const app of sortedApps) {
                    downloadsMap[app.id] = await statsManager.getDownloads(app.id);
                }
                
                // –°–æ–∑–¥–∞–µ–º –∫–∞—Ä—Ç–æ—á–∫–∏
                sortedApps.forEach(app => {
                    const appCard = document.createElement('div');
                    appCard.className = 'app-card';
                    
                    const imageContent = app.image 
                        ? `<img src="${app.image}" alt="${app.name}">`
                        : `<div class="no-image-text">üì∑ –§–æ—Ç–æ —É –¥–∞–Ω–Ω–æ–π –∏–≥—Ä—ã –Ω–µ—Ç—É</div>`;
                    
                    const downloads = downloadsMap[app.id] || 0;
                    const showNewBadge = isNew(app.added);
                    
                    appCard.innerHTML = `
                        <div class="app-image">
                            ${imageContent}
                            <div class="app-badges">
                                ${showNewBadge ? '<div class="new-badge">–ù–û–í–û–ï</div>' : ''}
                                <div class="version-badge">v${app.version}</div>
                                <div class="app-badge">C#</div>
                            </div>
                        </div>
                        <div class="app-content">
                            <h3 class="app-title">
                                ${app.name}
                            </h3>
                            <div class="app-rating">${renderStars(app.rating)}</div>
                            
                            <div class="app-meta">
                                <div class="meta-item">‚è±Ô∏è ${app.developmentTime}</div>
                                <div class="meta-item">üì¶ ${formatSize(app.fileSize, app.fileSizeUnit)}</div>
                                <div class="meta-item">üìÖ ${app.added}</div>
                                <div class="meta-item">üíæ ${downloads} —Å–∫–∞—á.</div>
                            </div>
                            
                            <p class="app-description">${app.description}</p>
                            
                            <div class="app-tags">
                                ${app.tags.map(tag => `<span class="app-tag">${tag}</span>`).join('')}
                            </div>
                            
                            <div class="app-details">
                                <div class="detail-row">
                                    <span class="detail-label">–í–µ—Ä—Å–∏—è:</span>
                                    <span class="detail-value">${app.version}</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">–Ø–∑—ã–∫:</span>
                                    <span class="detail-value">${app.language}</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">–¢—Ä–µ–±–æ–≤–∞–Ω–∏—è:</span>
                                    <span class="detail-value">${app.requirements}</span>
                                </div>
                                <div class="detail-row">
                                    <span class="detail-label">–û–±–Ω–æ–≤–ª–µ–Ω–æ:</span>
                                    <span class="detail-value">${app.updated}</span>
                                </div>
                            </div>
                            
                            <div class="app-actions">
                                <a href="${app.projectUrl}" 
                                   class="download-btn" 
                                   target="_blank"
                                   data-app-id="${app.id}">
                                    üì• –°–∫–∞—á–∞—Ç—å
                                </a>
                            </div>
                        </div>
                    `;
                    appsContainer.appendChild(appCard);
                });

                // –û–±—Ä–∞–±–æ—Ç—á–∏–∫–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏—è
                document.querySelectorAll('.download-btn').forEach(btn => {
                    btn.addEventListener('click', async function() {
                        const appId = parseInt(this.dataset.appId);
                        await statsManager.incrementDownloads(appId);
                        await updateStats();
                        
                        // –û–±–Ω–æ–≤–ª—è–µ–º —Å—á–µ—Ç—á–∏–∫ –Ω–∞ –∫–∞—Ä—Ç–æ—á–∫–µ
                        setTimeout(async () => {
                            await renderApps();
                        }, 100);
                    });
                });
            }

            // ============================
            // –§–£–ù–ö–¶–ò–Ø: –û–ë–ù–û–í–õ–ï–ù–ò–ï –°–¢–ê–¢–ò–°–¢–ò–ö–ò
            // ============================
            async function updateStats() {
                document.getElementById('totalApps').textContent = csharpApps.length;
                
                // –ü–æ–ª—É—á–∞–µ–º –æ–±—â–µ–µ –∫–æ–ª–∏—á–µ—Å—Ç–≤–æ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π —Å —Å–µ—Ä–≤–µ—Ä–∞
                const totalDownloads = await statsManager.getTotalDownloads();
                document.getElementById('totalDownloads').textContent = totalDownloads;
                
                // –ü–æ–¥—Å—á–µ—Ç –æ–±—â–∏—Ö —á–∞—Å–æ–≤
                const totalHours = csharpApps.reduce((sum, app) => {
                    const hours = parseInt(app.developmentTime);
                    return sum + (isNaN(hours) ? 0 : hours);
                }, 0);
                document.getElementById('totalHours').textContent = totalHours;
            }

            // ============================
            // –û–ë–†–ê–ë–û–¢–ß–ò–ö–ò –°–û–ë–´–¢–ò–ô
            // ============================
            searchInput.addEventListener('input', async function() {
                searchQuery = this.value;
                await renderApps();
            });

            // ============================
            // –ò–ù–ò–¶–ò–ê–õ–ò–ó–ê–¶–ò–Ø
            // ============================
            async function initialize() {
                // –ü–æ–∫–∞–∑—ã–≤–∞–µ–º –∏–Ω–¥–∏–∫–∞—Ç–æ—Ä –∑–∞–≥—Ä—É–∑–∫–∏
                appsContainer.innerHTML = '<div style="text-align: center; padding: 50px; color: #666;">‚è≥ –ó–∞–≥—Ä—É–∑–∫–∞...</div>';
                
                // –û–±–Ω–æ–≤–ª—è–µ–º –∏–Ω—Ñ–æ—Ä–º–∞—Ü–∏–æ–Ω–Ω—ã–π –±–∞–Ω–Ω–µ—Ä –≤ –∑–∞–≤–∏—Å–∏–º–æ—Å—Ç–∏ –æ—Ç —Ç–∏–ø–∞ —Ö—Ä–∞–Ω–∏–ª–∏—â–∞
                const infoBanner = document.querySelector('.info-banner');
                if (infoBanner) {
                    if (statsManager.useServerStorage) {
                        infoBanner.innerHTML = `
                            <span class="icon">üåê</span>
                            <span>–°—á–µ—Ç—á–∏–∫–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π —Å–∏–Ω—Ö—Ä–æ–Ω–∏–∑–∏—Ä—É—é—Ç—Å—è –º–µ–∂–¥—É –≤—Å–µ–º–∏ –ø–æ–ª—å–∑–æ–≤–∞—Ç–µ–ª—è–º–∏ –≤ —Ä–µ–∞–ª—å–Ω–æ–º –≤—Ä–µ–º–µ–Ω–∏!</span>
                        `;
                        infoBanner.style.background = 'linear-gradient(135deg, #00A859 0%, #008f4c 100%)';
                    } else {
                        infoBanner.innerHTML = `
                            <span class="icon">üíª</span>
                            <span>–°—á–µ—Ç—á–∏–∫–∏ —Å–∫–∞—á–∏–≤–∞–Ω–∏–π —Å–æ—Ö—Ä–∞–Ω—è—é—Ç—Å—è –ª–æ–∫–∞–ª—å–Ω–æ –≤ –≤–∞—à–µ–º –±—Ä–∞—É–∑–µ—Ä–µ (—Ç–æ–ª—å–∫–æ –¥–ª—è –≤–∞—Å)</span>
                        `;
                        infoBanner.style.background = 'linear-gradient(135deg, #68217A 0%, #4a1859 100%)';
                    }
                }
                
                renderFilters();
                await renderApps();
                await updateStats();
            }
            
            // –ó–∞–ø—É—Å–∫–∞–µ–º –∏–Ω–∏—Ü–∏–∞–ª–∏–∑–∞—Ü–∏—é
            initialize();
        });
    </script>
</body>
</html>
